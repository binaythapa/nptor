{% extends "quiz/base.html" %}
{% block content %}

<section class="section">
  <div class="container">

    <h1 class="title is-4">
      ğŸ’³ Subscription Plans â€“ {{ track.title }}
    </h1>

    <p class="has-text-grey mb-4">
      Choose a plan and contact admin to activate your subscription.
    </p>

    {% for plan in plans %}
    <div class="box">
      <div class="is-flex is-justify-content-space-between is-align-items-center">

        <div>
          <strong>{{ plan.name }}</strong><br>
          {% if plan.duration_days %}
            <span class="is-size-7 has-text-grey">
              Valid for {{ plan.duration_days }} days
            </span>
          {% else %}
            <span class="tag is-success is-light">Lifetime</span>
          {% endif %}
        </div>

        <div class="has-text-right">
          <strong>â‚¹{{ plan.price }}</strong>
        </div>
      </div>

      <div class="buttons mt-3">
        <!-- WHATSAPP -->
        <a class="button is-success is-small"
           target="_blank"
           href="https://wa.me/918754795806?text=
           Hi%20I%20want%20to%20subscribe%20to%20{{ track.title }}%20
           (%20{{ plan.name }}%20-%20â‚¹{{ plan.price }}%20)">
          ğŸ“ WhatsApp
        </a>

        <!-- VIBER -->
        <button class="button is-link is-small"
                onclick="openViber(
                  'Hi I want to subscribe to {{ track.title }} ({{ plan.name }} - â‚¹{{ plan.price }})'
                )">
          ğŸ“© Viber
        </button>
      </div>
    </div>
    {% empty %}
      <p class="has-text-danger">
        No active subscription plans available.
      </p>
    {% endfor %}

    <a href="{% url 'quiz:exam_list' %}"
       class="button is-light mt-4">
      â† Back to Exams
    </a>

  </div>
</section>

<script>
function openViber(message) {
  const encoded = encodeURIComponent(message);
  window.location.href =
    `viber://chat?number=918754795806&text=${encoded}`;
}
</script>

{% endblock %}
