{% extends "quiz/base.html" %}
{% block content %}

<h2 class="title is-4">ðŸ›  Admin Dashboard</h2>

<!-- ================= KPI CARDS ================= -->
<div class="columns is-multiline">
  <div class="column is-3">
    <div class="box has-text-centered">
      <p class="heading">Users</p>
      <p class="title">{{ total_users }}</p>
    </div>
  </div>

  <div class="column is-3">
    <div class="box has-text-centered">
      <p class="heading">Attempts</p>
      <p class="title">{{ total_attempts }}</p>
    </div>
  </div>

  <div class="column is-3">
    <div class="box has-text-centered has-text-success">
      <p class="heading">Pass Rate</p>
      <p class="title">{{ pass_rate }}%</p>
    </div>
  </div>

  <div class="column is-3">
    <div class="box has-text-centered has-text-info">
      <p class="heading">Avg Score</p>
      <p class="title">{{ avg_score }}%</p>
    </div>
  </div>
</div>

<!-- ================= SUBSCRIPTIONS ================= -->
<div class="box">
  <strong>Active Track Subscriptions:</strong> {{ active_track_subs }}
</div>

<!-- ================= TRACK ANALYTICS ================= -->
<h3 class="title is-5 mt-5">ðŸ“š Track Analytics</h3>

<table class="table is-fullwidth is-striped">
  <thead>
    <tr>
      <th>Track</th>
      <th>Enrolled</th>
      <th>Completed</th>
      <th>Completion %</th>
      <th>Avg Score</th>
      <th>Drop-off Exam</th>
    </tr>
  </thead>
  <tbody>
    {% for row in track_rows %}
    <tr>
      <td>{{ row.track.title }}</td>
      <td>{{ row.enrolled }}</td>
      <td>{{ row.completed }}</td>
      <td>{{ row.completion_rate }}%</td>
      <td>
        {% if row.avg_score %}
          {{ row.avg_score }}%
        {% else %}
          â€”
        {% endif %}
      </td>
      <td>{{ row.drop_exam }}</td>
    </tr>
    {% endfor %}
  </tbody>
</table>

{% endblock %}
